{"version":3,"sources":["assets\\scripts\\Player.ts"],"names":[],"mappings":";;;;;AAAA,oBAAoB;AACpB,wEAAwE;AACxE,mBAAmB;AACnB,kFAAkF;AAClF,8BAA8B;AAC9B,kFAAkF;;;;;;;;;;;;;;;;;;;;;AAE5E,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAAsC,4BAAY;IAAlD;QAAA,qEA8GC;QA5GG,SAAS;QAET,gBAAU,GAAG,CAAC,CAAC;QACf,WAAW;QAEX,kBAAY,GAAG,CAAC,CAAC;QACjB,SAAS;QAET,kBAAY,GAAG,CAAC,CAAC;QACjB,MAAM;QAEN,WAAK,GAAG,CAAC,CAAC;QAGF,aAAO,GAAY,KAAK,CAAC;QACzB,cAAQ,GAAY,KAAK,CAAC;QAClC,YAAM,GAAG,CAAC,CAAC;;IA4Ff,CAAC;IA3FG,yBAAM,GAAN;QACI,IAAM,UAAU,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;QACxC,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,KAAK,EAAE,CAAA;QAEvC,UAAU;QACV,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;QACrB,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;QACtB,aAAa;QACb,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;QAEhB,YAAY;QACZ,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,EAAE,CAAC,WAAW,CAAC,SAAS,CAAC,QAAQ,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;QAC3E,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,EAAE,CAAC,WAAW,CAAC,SAAS,CAAC,MAAM,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;IAChF,CAAC;IAED,4BAAS,GAAT;QACI,WAAW;QACX,EAAE,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE,CAAC,WAAW,CAAC,SAAS,CAAC,QAAQ,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;QAC5E,EAAE,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE,CAAC,WAAW,CAAC,SAAS,CAAC,MAAM,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;IAC5E,CAAC;IAED,wBAAK,GAAL;IAEA,CAAC;IAGD,gCAAa,GAAb;QACI,OAAO;QACP,IAAM,MAAM,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,YAAY,EAAE,EAAC,CAAC,EAAE,IAAI,CAAC,UAAU,EAAC,EAAE,EAAC,MAAM,EAAE,SAAS,EAAC,CAAC,CAAC;QAC3F,KAAK;QACL,IAAM,QAAQ,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,YAAY,EAAE,EAAC,CAAC,EAAE,CAAC,IAAI,CAAC,UAAU,EAAC,EAAE,EAAC,MAAM,EAAE,QAAQ,EAAC,CAAC,CAAC;QAE7F,mCAAmC;QACnC,IAAM,KAAK,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC,QAAQ,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAA;QACnD,QAAQ;QACR,OAAO,EAAE,CAAC,KAAK,EAAE,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;IAC3C,CAAC;IAED,4BAAS,GAAT,UAAW,KAAK;QACZ,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QAEnB,8BAA8B;QAC9B,QAAO,KAAK,CAAC,OAAO,EAAE;YAClB,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBACf,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;gBACpB,MAAM;YACV,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBACf,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;gBACrB,MAAM;SACb;IACL,CAAC;IAED,0BAAO,GAAP,UAAS,KAAK;QACV,iCAAiC;QACjC,QAAO,KAAK,CAAC,OAAO,EAAE;YAClB,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBACf,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;gBACrB,MAAM;YACV,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBACf,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;gBACtB,MAAM;SACb;IACL,CAAC;IAGD,qBAAqB;IACrB,yBAAM,GAAN,UAAQ,EAAE;QACN,kBAAkB;QAClB,IAAI,IAAI,CAAC,OAAO,EAAE;YACd,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;SAClC;aAAM,IAAI,IAAI,CAAC,QAAQ,EAAE;YACtB,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;SAClC;QACD,iBAAiB;QACjB,IAAK,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,YAAY,EAAG;YAC7C,6DAA6D;YAC7D,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;SACzE;QAED,gBAAgB;QAChB,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;QAEhC,sCAAsC;QACtC,IAAK,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,GAAC,CAAC,EAAE;YACzC,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,GAAC,CAAC,CAAC;YACvC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;SACnB;aAAM,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,GAAC,CAAC,EAAE;YAChD,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,GAAC,CAAC,CAAC;YACxC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;SACnB;IACL,CAAC;IAzGD;QADC,QAAQ;gDACM;IAGf;QADC,QAAQ;kDACQ;IAGjB;QADC,QAAQ;kDACQ;IAGjB;QADC,QAAQ;2CACC;IAbO,QAAQ;QAD5B,OAAO;OACa,QAAQ,CA8G5B;IAAD,eAAC;CA9GD,AA8GC,CA9GqC,EAAE,CAAC,SAAS,GA8GjD;kBA9GoB,QAAQ","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class NewClass extends cc.Component {\r\n\r\n    // 主角跳跃高度\r\n    @property\r\n    jumpHeight = 0;\r\n    // 主角跳跃持续时间\r\n    @property\r\n    jumpDuration = 0;\r\n    // 最大移动速度\r\n    @property\r\n    maxMoveSpeed = 0;\r\n    // 加速度\r\n    @property\r\n    accel = 0;\r\n\r\n    private jumpAction;\r\n    private accLeft: boolean = false;\r\n    private accRight: boolean = false;\r\n    xSpeed = 0;\r\n    onLoad () {\r\n        const jumpAction = this.runJumpAction();\r\n        cc.tween(this.node).then(jumpAction).start()\r\n\r\n             // 加速度方向开关\r\n             this.accLeft = false;\r\n             this.accRight = false;\r\n             // 主角当前水平方向速度\r\n             this.xSpeed = 0;\r\n     \r\n             // 初始化键盘输入监听\r\n             cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n             cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);   \r\n    }\r\n\r\n    onDestroy () {\r\n        // 取消键盘输入监听\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n    }\r\n\r\n    start () {\r\n        \r\n    }\r\n\r\n\r\n    runJumpAction () {\r\n        // 跳跃上升\r\n        const jumpUp = cc.tween().by(this.jumpDuration, {y: this.jumpHeight}, {easing: 'sineOut'});\r\n        // 下落\r\n        const jumpDown = cc.tween().by(this.jumpDuration, {y: -this.jumpHeight}, {easing: 'sineIn'});\r\n\r\n        // 创建一个缓动，按 jumpUp、jumpDown 的顺序执行动作\r\n        const tween = cc.tween().sequence(jumpUp, jumpDown)\r\n        // 不断重复 \r\n        return cc.tween().repeatForever(tween);\r\n    }\r\n\r\n    onKeyDown (event) {\r\n        console.log(event);\r\n        \r\n        // set a flag when key pressed\r\n        switch(event.keyCode) {\r\n            case cc.macro.KEY.a:\r\n                this.accLeft = true;\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.accRight = true;\r\n                break;\r\n        }\r\n    }\r\n\r\n    onKeyUp (event) {\r\n        // unset a flag when key released\r\n        switch(event.keyCode) {\r\n            case cc.macro.KEY.a:\r\n                this.accLeft = false;\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.accRight = false;\r\n                break;\r\n        }\r\n    }\r\n\r\n   \r\n    // called every frame\r\n    update (dt) {\r\n        // 根据当前加速度方向每帧更新速度\r\n        if (this.accLeft) {\r\n            this.xSpeed -= this.accel * dt;\r\n        } else if (this.accRight) {\r\n            this.xSpeed += this.accel * dt;\r\n        }\r\n        // 限制主角的速度不能超过最大值\r\n        if ( Math.abs(this.xSpeed) > this.maxMoveSpeed ) {\r\n            // if speed reach limit, use max speed with current direction\r\n            this.xSpeed = this.maxMoveSpeed * this.xSpeed / Math.abs(this.xSpeed);\r\n        }\r\n\r\n        // 根据当前速度更新主角的位置\r\n        this.node.x += this.xSpeed * dt;\r\n\r\n        // limit player position inside screen\r\n        if ( this.node.x > this.node.parent.width/2) {\r\n            this.node.x = this.node.parent.width/2;\r\n            this.xSpeed = 0;\r\n        } else if (this.node.x < -this.node.parent.width/2) {\r\n            this.node.x = -this.node.parent.width/2;\r\n            this.xSpeed = 0;\r\n        }\r\n    }\r\n}\r\n\r\n"]}